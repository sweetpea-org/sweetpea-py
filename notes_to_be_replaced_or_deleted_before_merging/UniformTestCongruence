import sys
sys.path.append("..")

import sweetpea

color = sweetpea.Factor('color', ['0', '1', '2', '3'])
word = sweetpea.Factor('word', ['0', '1', '2', '3'])

def congruent(color, word):
    return color == word

def incongruent(color, word):
    return not congruent(color, word)


incLevel = sweetpea.DerivedLevel('0', sweetpea.WithinTrial(incongruent,   [color, word]))
conLevel = sweetpea.DerivedLevel('1', sweetpea.WithinTrial(congruent,   [color, word]))

congruency = sweetpea.Factor('congruency', [
    conLevel,
    incLevel
])

design = [color, word, congruency]
crossing = [color, congruency]
constraints = []
block = sweetpea.CrossBlock(design, crossing, constraints)

word_counts = [0] * 4
seen = set()
n = 10000

experiments = sweetpea.synthesize_trials(block, n, sweetpea.UniformILPGen)
for i in range(n):
    total = ''.join(experiments[i]['color'] + experiments[i]['word'] + experiments[i]['transition'])
    seen.add(total)
    for j in range(8):
        word_counts[int(experiments[i]['word'][j])] += 1

print(len(seen))
print(word_counts)